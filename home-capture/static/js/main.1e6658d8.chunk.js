(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{18:function(e,t){},387:function(e,t,a){"use strict";a.r(t);var n=a(3),i=a.n(n),o=a(43),c=a.n(o),r=(a(52),a(9)),s=a(10),l=a(45),g=a(44),m=a(46),u=(a(54),a(13)),d=a.n(u),h=a(19),f=a.n(h),v="awsAccessKey",w="awsSecretKey",b=function(){function e(t,a){Object(r.a)(this,e);var n=t;this.lastModified=n.LastModified,this.size=n.Size,this.name=n.Key,this.data=a}return Object(s.a)(e,[{key:"toString",value:function(){return"name: ".concat(this.name,", size: ").concat(this.size,", lastModified: ").concat(this.lastModified)}}]),e}(),S=function(){function e(t,a){Object(r.a)(this,e),this.bucket=t,this.region=a;var n,i,o=new URLSearchParams(window.location.search);if("undefined"===typeof Storage)throw"No storage available. Are you from 1996? AWS doesn't exist yet anyway.";if(o.get(v)&&o.get(w))n=o.get(v),i=o.get(w),localStorage.setItem(v,n),localStorage.setItem(w,i);else{if(!localStorage.getItem(v)||!localStorage.getItem(w))throw"No credentials available";n=localStorage.getItem(v),i=localStorage.getItem(w)}var c=new d.a.Credentials(n,i);d.a.config.update({credentials:c,region:a}),this.S3=new d.a.S3}return Object(s.a)(e,[{key:"getImages",value:function(e,t){var a=new URLSearchParams(window.location.search),n=f.a.utc();a.get("date")&&(n=f()(a.get("date")));var i=n.format("YYYY-MM-DD");this.getObjects(e,t,i)}},{key:"getObjects",value:function(e,t,a,n){var i=this,o={Bucket:this.bucket,Prefix:a};n&&(o.ContinuationToken=n),this.S3.listObjectsV2(o).promise().then(function(n){var o=n.IsTruncated&&n.NextContinuationToken;o&&i.getObjects(e,t,a,n.NextContinuationToken);var c=n.Contents;e(c,!o),c.forEach(function(e){i.getObject(t,e)})})}},{key:"getObject",value:function(e,t){this.S3.getObject({Bucket:this.bucket,Key:t.Key}).promise().then(function(a){var n=new FileReader;n.onload=function(a){var n=a.target.result,i=new b(t,n);e(i)},n.readAsDataURL(new Blob([a.Body]))})}}]),e}(),k=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(g.a)(t).call(this,e))).metadataCallback=function(e,t){var n=a.state.metadata;n=n.concat(e),a.setState({metadata:n,metadataLoaded:t})},a.imageCallback=function(e){var t=a.state,n=t.images,i=t.metadata;a.preStateImages.push(e);var o=a.preStateImages.length,c=o+n.length,r=i.length;100!==o&&c!==r||(n=n.concat(a.preStateImages).sort(a.imageSortFn),a.setState({images:n}),a.preStateImages=[])},a.imageFinder=new S("home-motion-capture","us-west-2"),a.preStateImages=[],a.state={images:[],metadata:[],metadataLoaded:!1,loadedImageCount:0},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"imageSortFn",value:function(e,t){return t.lastModified-e.lastModified}},{key:"componentDidMount",value:function(){this.imageFinder.getImages(this.metadataCallback,this.imageCallback)}},{key:"render",value:function(){var e=this.state,t=e.images,a=e.metadataLoaded,n=e.metadata,o=null;n.length>0?t.length<n.length&&(o=a?"Fetching ".concat(n.length," images"):"Fetching at least ".concat(n.length," images")):o="Fetching metadata";var c=t.map(function(e){return i.a.createElement("span",{className:"image",key:e.name},i.a.createElement("img",{src:e.data,alt:e.toString()}))});return i.a.createElement("div",{className:"App"},i.a.createElement("div",null,o),c)}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},47:function(e,t,a){e.exports=a(387)},52:function(e,t,a){},54:function(e,t,a){}},[[47,2,1]]]);
//# sourceMappingURL=main.1e6658d8.chunk.js.map